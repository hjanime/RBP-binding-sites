clusters <- read.table("/media/skgthab/SAMSUNG/UCL-backup/2014.06.09@Kulozik-short-long-iCLIPalignment/PTB/4.pipeline/heatmap_extended_clusters/filter4/median_length/Clusters-PTB-iCLIP-Er-merged-filtered50p.bed", sep="\t")
clusters$length <- clusters$V3 - clusters$V2
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", x = length, ymin = `0%`, lower = `25%`, middle = `50%`, upper = `75%`, ymax = `100%`))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage",length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot(notchwidth = 0.5) + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot(notchwidth = 0.8) + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot(lower = 0.2) + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot(lower = 0.0) + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot(lower = 20) + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
median(clusters$length)
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))
clusters <- read.table("/media/skgthab/SAMSUNG/UCL-backup/2014.06.09@Kulozik-short-long-iCLIPalignment/PTB/4.pipeline/heatmap_extended_clusters/filter4/median_length/Clusters-PTB-iCLIP-Er-merged-filtered50p-length-sorted-200nt.bed", sep="\t")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
median(clusters$length)
median(clusters$length)
clusters$length <- clusters$V3 - clusters$V2
median(clusters$length)
clusters <- read.table("/media/skgthab/SAMSUNG/UCL-backup/2014.06.09@Kulozik-short-long-iCLIPalignment/PTB/4.pipeline/heatmap_extended_clusters/filter4/median_length/Clusters-PTB-iCLIP-Er-merged-filtered50p.bed", sep="\t")
clusters$length <- clusters$V3 - clusters$V2
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
scale_y_continuous(limits = c(0, 200))
library("ggplot2")
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))# +
#scale_y_continuous(limits = c(0, 200))
p <- ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) + scale_y_log10()
p + geom_boxplot() + theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))# +
#scale_y_continuous(limits = c(0, 200))
median(clusters$length)
boxplot.stats(clusters$length, coef = 1.5, do.conf = TRUE, do.out = TRUE)
require(ggplot2)
median.quartile <- function(x){
out <- quantile(x, probs = c(0.25,0.5,0.75))
names(out) <- c("ymin","y","ymax")
return(out)
}
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_violin()+
stat_summary(fun.y=clusters$length,geom='point')
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_violin()+
stat_summary(fun.y=length,geom='point')
fun.y=length
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_violin()+
stat_summary(fun.y=median.quartile,geom='point')
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point')
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='line')
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point') +
geom_hline(fun.y=median.quartile)
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point') +
geom_hline(aes(fun.y=median.quartile))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point') +
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point')
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point')
median.quartile
fun.y=median.quartile
fun.y
=median.quartile
median.quartile
median.quartile(clusters$length)
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point')
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length))+
geom_boxplot()+
stat_summary(fun.y=median.quartile,geom='point') + scale_y_log10()
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))# +
#stat_summary(fun.y=median.quartile,geom='point')
median.quartile(clusters$length)
quartile <- median.quartile(clusters$length)
quartile
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle(quartile) +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))# +
#stat_summary(fun.y=median.quartile,geom='point')
quartile[0]
quartile[1]
quartile[2]
quartile[3]
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
layer(data = quartile, mapping = aes(x = "", y=y, label=roundquartile$y))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
layer(data = quartile, mapping = aes(x = x, y=y, label=roundquartile$y))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
layer(data = quartile, mapping = aes(x = x, y=y, label=quartile$y))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
layer(aes(x = x, y=y, label=quartile$y))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
layer(aes(x = quartile$x, y=quartile$y, label=quartile$y))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = round(..y.., 1)), fun.y = mean, geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = round(length, 1)), geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = round(length, 1)),fun.y = mean, geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = round(clusters$length, 1)),fun.y = mean, geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = round(..y.., 1)),fun.y = mean, geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = 3,fun.y = mean, geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = 3, geom = "text",
size = 6, col = "red")
''
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = 3, geom = "text",
size = 6, col = "red")
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = 3, geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = 3, geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = quartile, geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(label = quartile[1], geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(quartile[1], geom = "text",
size = 6, col = "red"))
quartile[1]
quartile[1,1]
quartile[1,0]
quartile[1,2]
paste(quartile[1])
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(paste(quartile[1]), geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(paste(label=quartile[1]), geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(paste(label=quartile[1]),fun.y=mean, geom = "text",
size = 6, col = "red"))
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain")) +
stat_summary(aes(paste(label=quartile[1]), geom = "text",
size = 6, col = "red"))
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = mean, geom = "text",
size = 6, col = "red")
g_box
g0 <- ggplot(clusters, aes(x = "group", y = length))
g_box <- g0 + geom_boxplot(fill = "grey", colour = "black") + theme_bw()
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = mean, geom = "text",
size = 6, col = "red")
g_box
g0 <- ggplot(clusters, aes(x = "group", y = length))
g_box <- g0 + geom_boxplot(fill = "grey", colour = "black") + theme_bw()
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = mean, geom = "text",
size = 6, col = "red")+
scale_y_log10() +
g_box
g0 <- ggplot(clusters, aes(x = "group", y = length))
g_box <- g0 + geom_boxplot(fill = "grey", colour = "black") + theme_bw()
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = mean, geom = "text",
size = 6, col = "red")+
scale_y_log10()
g_box
g0 <- ggplot(clusters, aes(x = "group", y = length))
g_box <- g0 + geom_boxplot(fill = "grey", colour = "black") + theme_bw()
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = mean, geom = "text",
size = 6, col = "black")+
scale_y_log10()
g_box
g0 <- ggplot(clusters, aes(x = "group", y = length))
g_box <- g0 + geom_boxplot(fill = "grey", colour = "black") + theme_bw()
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = median, geom = "text",
size = 6, col = "black")+
scale_y_log10()
g_box
g0 <- ggplot(clusters, aes(x = "group", y = length))
g_box <- g0 + geom_boxplot(fill = "grey", colour = "black") + theme_bw()
g_box <- g_box + stat_summary(aes(label = round(..y.., 1)), fun.y = median, geom = "text",
size = 6, col = "black")
g_box
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("Median length") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))
quartile
ggplot(clusters, aes("PTB clusters with more then 50% pentamer coverage", length)) +
geom_boxplot() +
scale_y_log10() +
theme_bw() +
ggtitle("median quartile 25% (98nt), 50% (183nt), 75% (286nt)") +
xlab("") +
ylab("length (nt)") +
theme(text=element_text(size=12),axis.text=element_text(size=12), axis.title=element_text(size=12,face="plain"))
